{"ast":null,"code":"import axios from 'axios';\nimport { axiosWithAuth } from '../utils/axiosWithAuth';\nexport const SET_CHILD_ACTION = 'SET_CHILD_ACTION';\nexport const SET_IMMUNIZATION_ACTION = 'SET_IMMUNIZATION_ACTION';\nexport const SET_USER_ACTION = 'SET_USER_ACTION';\nexport const SET_DISPLAY_ACTION = 'SET_DISPLAY_ACTION';\nexport function loginAction(props, credentials) {\n  return function (dispatch) {\n    let userId = -1;\n    axiosWithAuth().post(\"/auth/login/\".concat(props.user), credentials).then(res => {\n      // console.log('RES FROM LOGIN: ', res);\n      localStorage.setItem('token', res.data.token);\n      userId = res.data.user.id;\n      dispatch({\n        type: SET_USER_ACTION,\n        payload: userId\n      });\n      getChildrenAction(userId, props)(dispatch);\n    }).catch(err => console.log('ERROR LOGIN: ', err));\n  };\n}\nexport function getImmunizations(childArr, history) {\n  return function (dispatch) {\n    childArr.map((child, index) => {\n      axiosWithAuth().get(\"/child/\".concat(child.id, \"/immunization\")).then(res => {\n        dispatch({\n          type: SET_IMMUNIZATION_ACTION,\n          payload: {\n            immuneObj: res.data,\n            index: index\n          }\n        }); // if(index === childArr.length - 1)\n        //     setTimeout(() => history.push(`/patient-home`), 1000);\n      }).catch(err => console.log('ERROR IMMUNIZATION REQ: ', err));\n    });\n    dispatch({\n      type: SET_DISPLAY_ACTION\n    });\n    history.push(\"/patient-home\");\n  };\n}\nexport function getChildrenAction(parentId, props) {\n  return function (dispatch) {\n    axiosWithAuth().get(\"/parent/\".concat(parentId, \"/children\")).then(res => {\n      dispatch({\n        type: SET_CHILD_ACTION,\n        payload: res.data\n      }); // console.log('SET CHILD');\n\n      getImmunizations(res.data, props.history)(dispatch);\n    }).catch(err => console.log('ERROR CHILD REQ: ', err));\n  };\n}\nexport const addChildAction = (parentId, childObj, props) => dispatch => {\n  axiosWithAuth().post(\"/parent/\".concat(parentId, \"/children\"), childObj).then(res => {\n    console.log('RES FROM ADD CHILD ACTION: ', res);\n    getChildrenAction(parentId, props)(dispatch);\n  }).catch(err => console.log('ERROR: ', err));\n};\nexport const updateChildAction = (childId, vacObj, props) => dispatch => {\n  axiosWithAuth().put(\"/child/immunization/\".concat(childId), vacObj).then(res => {\n    console.log('Success Put: ', res);\n    getChildrenAction(childId, props)(dispatch);\n  }).catch(err => console.log('ERROR: ', err));\n};","map":{"version":3,"sources":["C:\\Users\\Brandon Nichols\\Documents\\VScodeProjects\\BuildWeek-ImmunizationTracker\\Front-End\\immutrack\\src\\actions\\index.js"],"names":["axios","axiosWithAuth","SET_CHILD_ACTION","SET_IMMUNIZATION_ACTION","SET_USER_ACTION","SET_DISPLAY_ACTION","loginAction","props","credentials","dispatch","userId","post","user","then","res","localStorage","setItem","data","token","id","type","payload","getChildrenAction","catch","err","console","log","getImmunizations","childArr","history","map","child","index","get","immuneObj","push","parentId","addChildAction","childObj","updateChildAction","childId","vacObj","put"],"mappings":"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","sourcesContent":["import axios from 'axios';\r\nimport { axiosWithAuth } from '../utils/axiosWithAuth';\r\n\r\nexport const SET_CHILD_ACTION = 'SET_CHILD_ACTION';\r\nexport const SET_IMMUNIZATION_ACTION = 'SET_IMMUNIZATION_ACTION';\r\nexport const SET_USER_ACTION = 'SET_USER_ACTION';\r\nexport const SET_DISPLAY_ACTION = 'SET_DISPLAY_ACTION';\r\n\r\nexport function loginAction (props, credentials){\r\n    return function(dispatch){\r\n        let userId = -1;\r\n        axiosWithAuth()\r\n            .post(`/auth/login/${props.user}`, credentials)\r\n            .then(res => {\r\n                // console.log('RES FROM LOGIN: ', res);\r\n                localStorage.setItem('token', res.data.token);\r\n                userId = res.data.user.id;\r\n                dispatch({type: SET_USER_ACTION, payload: userId});\r\n                getChildrenAction(userId, props)(dispatch);\r\n            })\r\n            .catch(err => console.log('ERROR LOGIN: ', err));\r\n    }\r\n}\r\n\r\nexport function getImmunizations(childArr, history) {\r\n    return function(dispatch){\r\n        childArr.map((child, index) => {\r\n            axiosWithAuth().get(`/child/${child.id}/immunization`)\r\n            .then(res => {\r\n                    dispatch({type: SET_IMMUNIZATION_ACTION, payload: {immuneObj: res.data, index: index}});\r\n                    // if(index === childArr.length - 1)\r\n                    //     setTimeout(() => history.push(`/patient-home`), 1000);\r\n                })\r\n            .catch(err => console.log('ERROR IMMUNIZATION REQ: ', err));\r\n        });\r\n        dispatch({type: SET_DISPLAY_ACTION});\r\n        history.push(`/patient-home`);\r\n    }\r\n}\r\n\r\nexport function getChildrenAction(parentId, props){\r\n    return function(dispatch){\r\n        axiosWithAuth()\r\n           .get(`/parent/${parentId}/children`)\r\n           .then(res => {\r\n               dispatch({type: SET_CHILD_ACTION, payload: res.data});\r\n               // console.log('SET CHILD');\r\n               getImmunizations(res.data, props.history)(dispatch);\r\n           })\r\n           .catch(err => console.log('ERROR CHILD REQ: ', err));\r\n    }\r\n}\r\n\r\n\r\n\r\nexport const addChildAction = (parentId, childObj, props) => dispatch => {\r\n    axiosWithAuth()\r\n        .post(`/parent/${parentId}/children`, childObj)\r\n        .then(res => {\r\n            console.log('RES FROM ADD CHILD ACTION: ', res);\r\n            getChildrenAction(parentId, props)(dispatch);\r\n        })\r\n        .catch(err => console.log('ERROR: ', err));\r\n}\r\n\r\nexport const updateChildAction = (childId, vacObj, props) => dispatch => {\r\n    axiosWithAuth()\r\n        .put(`/child/immunization/${childId}`, vacObj)\r\n        .then(res => {\r\n            console.log('Success Put: ', res);\r\n            getChildrenAction(childId, props)(dispatch);\r\n        })\r\n        .catch(err => console.log('ERROR: ', err));\r\n}"]},"metadata":{},"sourceType":"module"}